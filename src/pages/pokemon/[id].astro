---
import Layout from "../../layouts/Layout.astro";
import {capitalizeFirstLetter, getPokemonsById, mapId, mapWHPokemon, 
        TypeColors, type PokemonSmall, type PokemonBig, type PokemonType } from "../../models/PokemonModels";
import PokemonCard from '../../components/PokemonEvolutionCard.astro';
const {id} = Astro.params;

export async function getStaticPaths() {
    const paths = [];
    for (let i = 1; i <= 1025; i++) { //FIXME  PONER CONSTANTE CON EL NUM TOTAL DE POKEMONS
        paths.push({params: {id: i.toString()}});
    }
    return paths;
}

const pokemon : PokemonBig | undefined = await getPokemonsById(parseInt(id));
---

<Layout title={pokemon!.basicData.name}>

    <section class="flex justify-evenly content-center 
    my-36">

    <div class="flex flex-col items-center text-center
    w-[500px] h-[500px]
    bg-slate-400/20 border-gray-500 border rounded-2xl">
        <h2 class="text-5xl font-bold tracking-widest my-8">{capitalizeFirstLetter(pokemon!.basicData.name)}</h2>
        <h3 class="text-xs tracking-widest">No. {mapId(pokemon!.basicData.id)}</h3>
        <img src={pokemon!.basicData.image} alt={pokemon!.basicData.name} 
        class="h-52 w-52" transition:name=`media-image-${pokemon!.basicData.name}`/>
        <div class="flex flex-col space-x-1 mt-1 p-1 gap-2">
            <span class="font-medium text-lg tracking-wide">Height: {mapWHPokemon(pokemon!.height)} m</span>
            <span class="font-medium text-lg tracking-wide">Weight: {mapWHPokemon(pokemon!.weight)} kg</span>
        </div>
        <div class="flex flex-row space-x-1 mt-1 p-1 gap-2">
            {pokemon?.basicData.types.map((types : PokemonType) => (
                <p class=` ${TypeColors[types.type.name]} 
                opacity-80 rounded text-white text-center 
                font-semibold text-lg tracking-wide p-1.5 ` 
                >{types.type.name}</p>
            ))}
        </div>
    </div>

    <div class="flex justify-evenly flex-col items-center text-center
    overflow-scroll 
    w-[500px] h-[500px] 
    bg-slate-400/20 border-gray-500 border rounded-2xl">

    <h2 class="text-5xl font-bold tracking-widest">Evoluciones</h2>
    {
        pokemon?.evolutions?.length === 1 ?  
        <p>Este pok√©mon no tiene evolucionnes</p>
        :
        pokemon?.evolutions?.map((pokemon : PokemonSmall, index: number) => (
        <PokemonCard {pokemon}/>  
        ))
        
    }
    </div>

    </section>

</Layout>

